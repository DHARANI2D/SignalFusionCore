(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,25652,e=>{"use strict";let t=(0,e.i(75254).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);e.s(["TrendingUp",()=>t],25652)},54983,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(98919);let l=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);var i=e.i(25652);function c(){let[e,c]=(0,s.useState)(null),[r,d]=(0,s.useState)([]),[n,h]=(0,s.useState)(""),[x,o]=(0,s.useState)("ip"),[m,p]=(0,s.useState)(null);(0,s.useEffect)(()=>{j(),u()},[]);let j=async()=>{try{let e=await fetch("http://localhost:8001/api/threat-intel/stats"),t=await e.json();c(t)}catch(e){console.error("Failed to fetch stats:",e)}},u=async()=>{try{let e=await fetch("http://localhost:8001/api/threat-intel/matches?limit=20"),t=await e.json();d(t.matches||[])}catch(e){console.error("Failed to fetch matches:",e)}},g=async()=>{if(n)try{let e=await fetch(`http://localhost:8001/api/threat-intel/ioc/${n}?type=${x}`),t=await e.json();p(t)}catch(e){console.error("Search failed:",e)}},v=async()=>{try{let e=await fetch("http://localhost:8001/api/threat-intel/feeds/update",{method:"POST"}),t=await e.json();alert(t.message),j()}catch(e){console.error("Feed update failed:",e)}};return(0,t.jsxs)("div",{className:"flex flex-col gap-8 flex-1 max-w-7xl mx-auto w-full",children:[(0,t.jsxs)("header",{className:"flex justify-between items-end",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Threat Intelligence"}),(0,t.jsx)("p",{className:"text-white/50 mt-1",children:"IOC management and threat feed integration"})]}),(0,t.jsxs)("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium transition-all",children:[(0,t.jsx)(i.TrendingUp,{className:"w-4 h-4"}),"Update Feeds"]})]}),(0,t.jsxs)("section",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,t.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-blue-500/5",children:[(0,t.jsx)("div",{className:"text-sm text-white/40 mb-2",children:"Total IOCs"}),(0,t.jsx)("div",{className:"text-3xl font-bold",children:e?.total||0})]}),(0,t.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-green-500/5",children:[(0,t.jsx)("div",{className:"text-sm text-white/40 mb-2",children:"Active IOCs"}),(0,t.jsx)("div",{className:"text-3xl font-bold text-green-400",children:e?.active||0})]}),(0,t.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-orange-500/5",children:[(0,t.jsx)("div",{className:"text-sm text-white/40 mb-2",children:"Recent Matches"}),(0,t.jsx)("div",{className:"text-3xl font-bold text-orange-400",children:e?.recentMatches||0})]}),(0,t.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-purple-500/5",children:[(0,t.jsx)("div",{className:"text-sm text-white/40 mb-2",children:"IOC Types"}),(0,t.jsx)("div",{className:"text-3xl font-bold",children:e?.byType?.length||0})]})]}),(0,t.jsxs)("section",{className:"glass-panel p-6 shadow-lg shadow-blue-500/5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,t.jsx)(l,{className:"w-4 h-4 text-blue-400"}),(0,t.jsx)("h3",{className:"text-sm font-bold text-white/30 uppercase tracking-widest",children:"IOC Lookup"})]}),(0,t.jsxs)("div",{className:"flex gap-3 mb-4",children:[(0,t.jsxs)("select",{value:x,onChange:e=>o(e.target.value),className:"bg-white/5 text-white rounded-lg px-3 py-2 border border-white/10 text-sm focus:outline-none focus:border-blue-500/50",children:[(0,t.jsx)("option",{value:"ip",children:"IP Address"}),(0,t.jsx)("option",{value:"domain",children:"Domain"}),(0,t.jsx)("option",{value:"hash",children:"Hash"}),(0,t.jsx)("option",{value:"url",children:"URL"}),(0,t.jsx)("option",{value:"email",children:"Email"})]}),(0,t.jsx)("input",{type:"text",value:n,onChange:e=>h(e.target.value),onKeyPress:e=>"Enter"===e.key&&g(),placeholder:"Enter IOC value...",className:"flex-1 bg-white/5 text-white rounded-lg px-3 py-2 border border-white/10 text-sm focus:outline-none focus:border-blue-500/50"}),(0,t.jsx)("button",{onClick:g,className:"px-6 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium transition-all",children:"Search"})]}),m&&(0,t.jsx)("div",{className:`p-4 rounded-lg border ${m.found?"bg-red-500/10 border-red-500/30":"bg-green-500/10 border-green-500/30"}`,children:m.found?(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)(a.Shield,{className:"w-5 h-5 text-red-400"}),(0,t.jsx)("span",{className:"font-bold text-red-400",children:"Threat Detected"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-white/40 text-xs",children:"IOC Value"}),(0,t.jsx)("div",{className:"font-mono",children:m.iocValue})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-white/40 text-xs",children:"Type"}),(0,t.jsx)("div",{children:m.iocType})]}),m.threatActor&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-white/40 text-xs",children:"Threat Actor"}),(0,t.jsx)("div",{children:m.threatActor})]}),m.malwareFamily&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-white/40 text-xs",children:"Malware Family"}),(0,t.jsx)("div",{children:m.malwareFamily})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-white/40 text-xs",children:"Severity"}),(0,t.jsx)("div",{className:"capitalize",children:m.severity})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-white/40 text-xs",children:"Confidence"}),(0,t.jsx)("div",{className:"capitalize",children:m.confidence})]})]})]}):(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(a.Shield,{className:"w-5 h-5 text-green-400"}),(0,t.jsx)("span",{className:"text-green-400",children:"No threat intelligence found for this IOC"})]})})]}),(0,t.jsxs)("section",{className:"glass-panel p-6 shadow-lg shadow-purple-500/5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,t.jsx)(a.Shield,{className:"w-4 h-4 text-purple-400"}),(0,t.jsx)("h3",{className:"text-sm font-bold text-white/30 uppercase tracking-widest",children:"Recent IOC Matches"})]}),(0,t.jsx)("div",{className:"space-y-2",children:0===r.length?(0,t.jsx)("div",{className:"text-center text-white/30 text-sm py-8",children:"No IOC matches yet"}):r.map(e=>(0,t.jsx)("div",{className:"p-3 rounded-lg bg-white/5 border border-white/10 hover:bg-white/10 transition-colors",children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[(0,t.jsx)("span",{className:"font-mono text-sm",children:e.iocValue}),(0,t.jsx)("span",{className:"text-xs bg-purple-500/20 text-purple-300 px-2 py-0.5 rounded",children:e.iocType}),(0,t.jsx)("span",{className:`text-xs px-2 py-0.5 rounded ${"critical"===e.severity?"bg-red-500/20 text-red-300":"high"===e.severity?"bg-orange-500/20 text-orange-300":"bg-yellow-500/20 text-yellow-300"}`,children:e.severity})]}),(0,t.jsxs)("div",{className:"text-xs text-white/40",children:["Matched in ",e.matchedField," â€¢ ",new Date(e.createdAt).toLocaleString()]})]})})},e.id))})]})]})}e.s(["default",()=>c],54983)}]);