(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,63209,e=>{"use strict";let t=(0,e.i(75254).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],63209)},18393,e=>{"use strict";let t=(0,e.i(75254).default)("server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);e.s(["Server",()=>t],18393)},67585,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"BailoutToCSR",{enumerable:!0,get:function(){return r}});let l=e.r(32061);function r({reason:e,children:t}){if("undefined"==typeof window)throw Object.defineProperty(new l.BailoutToCSRError(e),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return t}},9885,(e,t,s)=>{"use strict";function l(e){return e.split("/").map(e=>encodeURIComponent(e)).join("/")}Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"encodeURIPath",{enumerable:!0,get:function(){return l}})},52157,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"PreloadChunks",{enumerable:!0,get:function(){return d}});let l=e.r(43476),r=e.r(74080),a=e.r(63599),i=e.r(9885),n=e.r(43369);function d({moduleIds:e}){if("undefined"!=typeof window)return null;let t=a.workAsyncStorage.getStore();if(void 0===t)return null;let s=[];if(t.reactLoadableManifest&&e){let l=t.reactLoadableManifest;for(let t of e){if(!l[t])continue;let e=l[t].files;s.push(...e)}}if(0===s.length)return null;let d=(0,n.getDeploymentIdQueryOrEmptyString)();return(0,l.jsx)(l.Fragment,{children:s.map(e=>{let s=`${t.assetPrefix}/_next/${(0,i.encodeURIPath)(e)}${d}`;return e.endsWith(".css")?(0,l.jsx)("link",{precedence:"dynamic",href:s,rel:"stylesheet",as:"style",nonce:t.nonce},e):((0,r.preload)(s,{as:"script",fetchPriority:"low",nonce:t.nonce}),null)})})}},69093,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return c}});let l=e.r(43476),r=e.r(71645),a=e.r(67585),i=e.r(52157);function n(e){return{default:e&&"default"in e?e.default:e}}let d={loader:()=>Promise.resolve(n(()=>null)),loading:null,ssr:!0},c=function(e){let t={...d,...e},s=(0,r.lazy)(()=>t.loader().then(n)),c=t.loading;function o(e){let n=c?(0,l.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,d=!t.ssr||!!t.loading,o=d?r.Suspense:r.Fragment,x=t.ssr?(0,l.jsxs)(l.Fragment,{children:["undefined"==typeof window?(0,l.jsx)(i.PreloadChunks,{moduleIds:t.modules}):null,(0,l.jsx)(s,{...e})]}):(0,l.jsx)(a.BailoutToCSR,{reason:"next/dynamic",children:(0,l.jsx)(s,{...e})});return(0,l.jsx)(o,{...d?{fallback:n}:{},children:x})}return o.displayName="LoadableComponent",o}},70703,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return r}});let l=e.r(55682)._(e.r(69093));function r(e,t){let s={};"function"==typeof e&&(s.loader=e);let r={...s,...t};return(0,l.default)({...r,modules:r.loadableGenerated?.modules})}("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),t.exports=s.default)},45716,e=>{"use strict";var t=e.i(43476),s=e.i(71645),l=e.i(78094),r=e.i(63209);let a=(0,e.i(75254).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);var i=e.i(18393),n=e.i(21218),d=e.i(98919);let c=(0,e.i(70703).default)(()=>e.A(13124).then(e=>e.GraphViewer),{loadableGenerated:{modules:[8252]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"flex items-center justify-center h-full text-white/50",children:"Loading graph..."})});function o(){let[e,o]=(0,s.useState)([]),[x,h]=(0,s.useState)(null),[u,m]=(0,s.useState)(null),[p,f]=(0,s.useState)(!0);(0,s.useEffect)(()=>{g(),j()},[]);let g=async()=>{try{let e=await fetch("http://localhost:8001/api/attack-graph/chains"),t=await e.json();o(t.chains||[]),f(!1)}catch(e){console.error("Failed to fetch chains:",e),f(!1)}},j=async()=>{try{let e=await fetch("http://localhost:8001/api/attack-graph/export?format=cytoscape"),t=await e.json();h(t)}catch(e){console.error("Failed to fetch graph:",e)}};return p?(0,t.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,t.jsxs)("div",{className:"text-white/50 flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),"Loading attack graph..."]})}):(0,t.jsxs)("div",{className:"flex flex-col gap-8 flex-1 max-w-7xl mx-auto w-full",children:[(0,t.jsxs)("header",{className:"flex justify-between items-end border-b border-white/5 pb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight bg-gradient-to-r from-white via-white to-white/50 bg-clip-text text-transparent",children:"Attack Graph"}),(0,t.jsx)("p",{className:"text-white/40 mt-2 text-sm",children:"Visualize attack chains and lateral movement"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-white/30",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),(0,t.jsx)("span",{children:"Live Data"})]})]}),(0,t.jsxs)("section",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,t.jsx)("div",{className:"glass-panel p-6 shadow-lg shadow-blue-500/5 hover:shadow-blue-500/10 transition-all group",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-blue-500/10 border border-blue-500/20 flex items-center justify-center group-hover:bg-blue-500/20 transition-all",children:(0,t.jsx)(l.Network,{className:"w-5 h-5 text-blue-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-white/40",children:"Attack Chains"}),(0,t.jsx)("div",{className:"text-2xl font-bold mt-1",children:e.length})]})]})}),(0,t.jsx)("div",{className:"glass-panel p-6 shadow-lg shadow-orange-500/5 hover:shadow-orange-500/10 transition-all group",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-orange-500/10 border border-orange-500/20 flex items-center justify-center group-hover:bg-orange-500/20 transition-all",children:(0,t.jsx)(r.AlertCircle,{className:"w-5 h-5 text-orange-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-white/40",children:"Active Chains"}),(0,t.jsx)("div",{className:"text-2xl font-bold mt-1",children:e.filter(e=>"active"===e.status).length})]})]})}),(0,t.jsx)("div",{className:"glass-panel p-6 shadow-lg shadow-purple-500/5 hover:shadow-purple-500/10 transition-all group",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-purple-500/10 border border-purple-500/20 flex items-center justify-center group-hover:bg-purple-500/20 transition-all",children:(0,t.jsx)(a,{className:"w-5 h-5 text-purple-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-white/40",children:"Affected Users"}),(0,t.jsx)("div",{className:"text-2xl font-bold mt-1",children:new Set(e.flatMap(e=>e.users?JSON.parse(e.users):[])).size||0})]})]})}),(0,t.jsx)("div",{className:"glass-panel p-6 shadow-lg shadow-green-500/5 hover:shadow-green-500/10 transition-all group",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-green-500/10 border border-green-500/20 flex items-center justify-center group-hover:bg-green-500/20 transition-all",children:(0,t.jsx)(i.Server,{className:"w-5 h-5 text-green-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-white/40",children:"Affected Hosts"}),(0,t.jsx)("div",{className:"text-2xl font-bold mt-1",children:new Set(e.flatMap(e=>e.hosts?JSON.parse(e.hosts):[])).size||0})]})]})})]}),(0,t.jsxs)("section",{className:"glass-panel p-6 shadow-lg shadow-blue-500/5",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-500/10 border border-blue-500/20 flex items-center justify-center",children:(0,t.jsx)(l.Network,{className:"w-4 h-4 text-blue-400"})}),(0,t.jsx)("h3",{className:"text-sm font-bold text-white/60 uppercase tracking-widest",children:"Interactive Graph"})]})}),(0,t.jsx)("div",{className:"h-[600px] rounded-lg overflow-hidden",children:x?(0,t.jsx)(c,{graphData:x}):(0,t.jsx)("div",{className:"flex items-center justify-center h-full bg-black/20 rounded-lg border border-white/10",children:(0,t.jsx)("div",{className:"text-white/40",children:"Loading graph data..."})})})]}),(0,t.jsxs)("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-blue-500/5",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-500/10 border border-blue-500/20 flex items-center justify-center",children:(0,t.jsx)(n.Activity,{className:"w-4 h-4 text-blue-400"})}),(0,t.jsx)("h3",{className:"text-sm font-bold text-white/60 uppercase tracking-widest",children:"Detected Chains"})]})}),(0,t.jsx)("div",{className:"space-y-3 max-h-[600px] overflow-y-auto",children:0===e.length?(0,t.jsxs)("div",{className:"text-center text-white/20 text-sm py-12 flex flex-col items-center gap-3",children:[(0,t.jsx)(l.Network,{className:"w-12 h-12 text-white/10"}),(0,t.jsx)("p",{children:"No attack chains detected"})]}):e.map(e=>(0,t.jsxs)("div",{onClick:()=>m(e),className:`p-4 rounded-lg border cursor-pointer transition-all ${u?.id===e.id?"bg-blue-500/20 border-blue-500/50":"bg-white/5 border-white/10 hover:bg-white/10"}`,children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,t.jsx)("div",{className:"font-medium",children:e.name}),(0,t.jsx)("span",{className:`text-xs px-2 py-1 rounded border ${(e=>{switch(e.toLowerCase()){case"critical":return"text-red-400 bg-red-500/20 border-red-500/30";case"high":return"text-orange-400 bg-orange-500/20 border-orange-500/30";case"medium":return"text-yellow-400 bg-yellow-500/20 border-yellow-500/30";default:return"text-blue-400 bg-blue-500/20 border-blue-500/30"}})(e.severity)}`,children:e.severity})]}),(0,t.jsx)("div",{className:"text-xs text-white/40 mb-3",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-xs",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(n.Activity,{className:"w-3 h-3 text-white/40"}),(0,t.jsxs)("span",{className:"text-white/60",children:[JSON.parse(e.nodeIds).length," events"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(d.Shield,{className:"w-3 h-3 text-white/40"}),(0,t.jsxs)("span",{className:"text-white/60",children:["Risk: ",Math.round(e.riskScore||0)]})]})]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mt-3",children:JSON.parse(e.tactics).slice(0,3).map((e,s)=>(0,t.jsx)("span",{className:"text-xs bg-purple-500/20 text-purple-300 px-2 py-0.5 rounded border border-purple-500/30",children:e},s))})]},e.id))})]}),(0,t.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-purple-500/5",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-lg bg-purple-500/10 border border-purple-500/20 flex items-center justify-center",children:(0,t.jsx)(l.Network,{className:"w-4 h-4 text-purple-400"})}),(0,t.jsx)("h3",{className:"text-sm font-bold text-white/60 uppercase tracking-widest",children:"Chain Details"})]})}),u?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-white/40 mb-2",children:"Timeline"}),(0,t.jsx)("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-white/40 text-xs",children:"Start"}),(0,t.jsx)("div",{className:"font-mono text-xs mt-1",children:new Date(u.startTime).toLocaleString()})]}),(0,t.jsx)("div",{className:"text-white/40",children:"â†’"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-white/40 text-xs",children:"End"}),(0,t.jsx)("div",{className:"font-mono text-xs mt-1",children:u.endTime?new Date(u.endTime).toLocaleString():"Ongoing"})]})]})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-white/40 mb-2",children:"MITRE ATT&CK Coverage"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-white/50 mb-1",children:"Tactics"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:JSON.parse(u.tactics).map((e,s)=>(0,t.jsx)("span",{className:"text-xs bg-blue-500/20 text-blue-300 px-2 py-1 rounded border border-blue-500/30",children:e},s))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-white/50 mb-1",children:"Techniques"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:JSON.parse(u.techniques).map((e,s)=>(0,t.jsx)("span",{className:"text-xs bg-purple-500/20 text-purple-300 px-2 py-1 rounded border border-purple-500/30 font-mono",children:e},s))})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-white/40 mb-2",children:"Risk Assessment"}),(0,t.jsxs)("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm",children:"Risk Score"}),(0,t.jsxs)("span",{className:"text-lg font-bold",children:[Math.round(u.riskScore||0),"/100"]})]}),(0,t.jsx)("div",{className:"h-2 bg-white/5 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-gradient-to-r from-orange-500 to-red-500",style:{width:`${u.riskScore||0}%`}})})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 pt-4 border-t border-white/5",children:[(0,t.jsx)("button",{className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium py-2 px-4 rounded-lg transition-all",children:"Investigate"}),(0,t.jsx)("button",{className:"flex-1 bg-white/10 hover:bg-white/20 text-white text-sm font-medium py-2 px-4 rounded-lg transition-all",children:"Mark Resolved"})]})]}):(0,t.jsxs)("div",{className:"text-center text-white/20 text-sm py-20 flex flex-col items-center gap-3",children:[(0,t.jsx)(d.Shield,{className:"w-16 h-16 text-white/10"}),(0,t.jsx)("p",{children:"Select a chain to view details"})]})]})]})]})}e.s(["default",()=>o],45716)},13124,e=>{e.v(t=>Promise.all(["static/chunks/90ebea9874ed6961.js"].map(t=>e.l(t))).then(()=>t(8252)))}]);