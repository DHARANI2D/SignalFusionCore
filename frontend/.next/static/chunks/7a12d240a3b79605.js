(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31343,e=>{"use strict";let t=(0,e.i(75254).default)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);e.s(["Play",()=>t],31343)},3116,e=>{"use strict";let t=(0,e.i(75254).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>t],3116)},69638,73884,e=>{"use strict";var t=e.i(75254);let s=(0,t.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>s],69638);let a=(0,t.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>a],73884)},84554,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(39312),l=e.i(31343),i=e.i(3116),r=e.i(69638),c=e.i(73884);let n=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);function o(){let[e,o]=(0,s.useState)([]),[d,x]=(0,s.useState)([]),[h,m]=(0,s.useState)(!0),[p,u]=(0,s.useState)(!1),[b,g]=(0,s.useState)([]),[j,w]=(0,s.useState)({name:"",description:"",trigger:{severity:"High",riskScore:70},actions:[{name:"Notify Security Team",actionType:"notify_slack",parameters:{channel:"#soc-alerts",message:"High severity alert detected"}}],retroactive:!1}),[N,y]=(0,s.useState)(null),[f,v]=(0,s.useState)("");(0,s.useEffect)(()=>{C(),S(),k()},[]);let k=async()=>{try{let e=await fetch("http://localhost:8001/api/alerts"),t=await e.json();g(t||[]),t&&t.length>0&&v(t[0].id)}catch(e){console.error("Failed to fetch alerts:",e)}},C=async()=>{try{let e=await fetch("http://localhost:8001/api/playbooks"),t=await e.json();o(t.playbooks||[]),m(!1)}catch(e){console.error("Failed to fetch playbooks:",e),m(!1)}},S=async()=>{try{let e=await fetch("http://localhost:8001/api/playbooks/executions"),t=await e.json();x(t.executions||[])}catch(e){console.error("Failed to fetch executions:",e)}},T=async()=>{try{let e=await fetch("http://localhost:8001/api/playbooks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)}),t=await e.json();t.success&&(j.retroactive&&await fetch(`http://localhost:8001/api/playbooks/${t.playbook.id}/retroactive`,{method:"POST"}),C(),S(),u(!1))}catch(e){console.error("Failed to create playbook:",e)}},A=async()=>{try{let e=await fetch("http://localhost:8001/api/playbooks/simulate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({playbook:j,alertId:f})}),t=await e.json();y(t)}catch(e){console.error("Failed to simulate playbook:",e)}};return h?(0,t.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,t.jsx)("div",{className:"text-white/50",children:"Loading playbooks..."})}):(0,t.jsxs)("div",{className:"flex flex-col gap-8 flex-1 max-w-7xl mx-auto w-full",children:[(0,t.jsxs)("header",{className:"flex justify-between items-end",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Response Playbooks"}),(0,t.jsx)("p",{className:"text-white/50 mt-1",children:"Automated incident response workflows"})]}),(0,t.jsxs)("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium transition-all",children:[(0,t.jsx)(n,{className:"w-4 h-4"}),"Create Playbook"]})]}),p&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:(0,t.jsxs)("div",{className:"glass-panel w-full max-w-2xl max-h-[90vh] overflow-y-auto p-8 shadow-2xl",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-bold",children:"Create New Playbook"}),(0,t.jsx)("button",{onClick:()=>u(!1),className:"text-white/40 hover:text-white",children:"âœ•"})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold text-white/40 uppercase mb-2",children:"Name"}),(0,t.jsx)("input",{type:"text",value:j.name,onChange:e=>w({...j,name:e.target.value}),className:"w-full bg-white/5 border border-white/10 rounded-lg px-4 py-2 text-sm focus:border-blue-500/50 outline-none transition-all",placeholder:"e.g. Isolate Ransomware"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold text-white/40 uppercase mb-2",children:"Trigger Severity"}),(0,t.jsxs)("select",{value:j.trigger.severity,onChange:e=>w({...j,trigger:{...j.trigger,severity:e.target.value}}),className:"w-full bg-[#0a0a0c] border border-white/10 rounded-lg px-4 py-2 text-sm focus:border-blue-500/50 outline-none transition-all",children:[(0,t.jsx)("option",{value:"Critical",children:"Critical"}),(0,t.jsx)("option",{value:"High",children:"High"}),(0,t.jsx)("option",{value:"Medium",children:"Medium"}),(0,t.jsx)("option",{value:"Low",children:"Low"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold text-white/40 uppercase mb-2",children:"Description"}),(0,t.jsx)("textarea",{value:j.description,onChange:e=>w({...j,description:e.target.value}),className:"w-full bg-white/5 border border-white/10 rounded-lg px-4 py-2 text-sm h-20 focus:border-blue-500/50 outline-none transition-all",placeholder:"What does this playbook do?"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold text-white/40 uppercase mb-2",children:"Actions"}),(0,t.jsxs)("div",{className:"space-y-2",children:[j.actions.map((e,s)=>(0,t.jsxs)("div",{className:"bg-white/5 border border-white/10 rounded-lg p-3 flex justify-between items-center text-sm",children:[(0,t.jsxs)("span",{children:[e.name," (",e.actionType,")"]}),(0,t.jsx)("button",{onClick:()=>{let e=[...j.actions];e.splice(s,1),w({...j,actions:e})},className:"text-red-400",children:"Remove"})]},s)),(0,t.jsx)("button",{onClick:()=>w({...j,actions:[...j.actions,{name:"New Action",actionType:"isolate_host",parameters:{}}]}),className:"w-full py-2 border border-dashed border-white/20 rounded-lg text-xs text-white/40 hover:text-white/60 transition-all",children:"+ Add Action"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 bg-blue-500/10 border border-blue-500/20 p-4 rounded-lg",children:[(0,t.jsx)("input",{type:"checkbox",id:"retro",checked:j.retroactive,onChange:e=>w({...j,retroactive:e.target.checked}),className:"w-4 h-4 rounded"}),(0,t.jsx)("label",{htmlFor:"retro",className:"text-sm font-medium",children:"Retroactive Execution: Run on existing alerts matching criteria"})]}),(0,t.jsxs)("div",{className:"border-t border-white/5 pt-6",children:[(0,t.jsx)("h3",{className:"text-sm font-bold text-white/60 mb-4",children:"PLAYBOOK SIMULATOR"}),(0,t.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,t.jsx)("select",{value:f,onChange:e=>v(e.target.value),className:"flex-1 bg-[#0a0a0c] border border-white/10 rounded-lg px-4 py-2 text-sm",children:b.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.summary.slice(0,50),"..."]},e.id))}),(0,t.jsx)("button",{onClick:A,className:"px-6 py-2 bg-purple-500/20 border border-purple-500/30 text-purple-300 rounded-lg text-sm font-bold hover:bg-purple-500/30 transition-all",children:"Simulate"})]}),N&&(0,t.jsxs)("div",{className:`p-4 rounded-lg border ${N.matched?"bg-green-500/10 border-green-500/30":"bg-red-500/10 border-red-500/30"}`,children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,t.jsxs)("span",{className:"font-bold text-sm",children:["Result: ",N.matched?"MATCH":"NO MATCH"]}),(0,t.jsx)("span",{className:"text-xs",children:N.predictedOutcome})]}),(0,t.jsxs)("div",{className:"text-xs text-white/40",children:["Alert: ",N.alertSummary," (",N.alertSeverity,")"]})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-6 border-t border-white/5",children:[(0,t.jsx)("button",{onClick:()=>u(!1),className:"flex-1 px-4 py-2 rounded-lg bg-white/5 hover:bg-white/10 text-white text-sm font-medium transition-all",children:"Cancel"}),(0,t.jsx)("button",{onClick:T,className:"flex-1 px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium transition-all shadow-lg shadow-blue-500/20",children:"Create & Enable"})]})]})]})}),(0,t.jsxs)("section",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,t.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-blue-500/5",children:[(0,t.jsx)("div",{className:"text-sm text-white/40 mb-2",children:"Total Playbooks"}),(0,t.jsx)("div",{className:"text-3xl font-bold",children:e.length})]}),(0,t.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-green-500/5",children:[(0,t.jsx)("div",{className:"text-sm text-white/40 mb-2",children:"Enabled"}),(0,t.jsx)("div",{className:"text-3xl font-bold text-green-400",children:e.filter(e=>e.enabled).length})]}),(0,t.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-purple-500/5",children:[(0,t.jsx)("div",{className:"text-sm text-white/40 mb-2",children:"Total Executions"}),(0,t.jsx)("div",{className:"text-3xl font-bold text-purple-400",children:e.reduce((e,t)=>e+(t.executionCount||0),0)})]}),(0,t.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-orange-500/5",children:[(0,t.jsx)("div",{className:"text-sm text-white/40 mb-2",children:"Success Rate"}),(0,t.jsxs)("div",{className:"text-3xl font-bold text-green-400",children:[e.length>0?Math.round(e.reduce((e,t)=>e+(t.successCount||0),0)/Math.max(e.reduce((e,t)=>e+(t.executionCount||0),0),1)*100):0,"%"]})]})]}),(0,t.jsxs)("section",{className:"glass-panel p-6 shadow-lg shadow-blue-500/5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,t.jsx)(a.Zap,{className:"w-4 h-4 text-blue-400"}),(0,t.jsx)("h3",{className:"text-sm font-bold text-white/30 uppercase tracking-widest",children:"Active Playbooks"})]}),(0,t.jsx)("div",{className:"space-y-3",children:0===e.length?(0,t.jsx)("div",{className:"text-center text-white/30 text-sm py-8",children:"No playbooks configured"}):e.map(e=>(0,t.jsxs)("div",{className:"p-4 rounded-lg bg-white/5 border border-white/10 hover:bg-white/10 transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[(0,t.jsx)("span",{className:"font-medium",children:e.name}),(0,t.jsx)("span",{className:`text-xs px-2 py-1 rounded ${e.enabled?"bg-green-500/20 text-green-300":"bg-gray-500/20 text-gray-400"}`,children:e.enabled?"Enabled":"Disabled"}),e.autoExecute&&(0,t.jsx)("span",{className:"text-xs bg-blue-500/20 text-blue-300 px-2 py-1 rounded",children:"Auto"})]}),(0,t.jsx)("div",{className:"text-xs text-white/40",children:e.description||"No description"})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-sm font-bold",children:e.executionCount}),(0,t.jsx)("div",{className:"text-xs text-white/40",children:"executions"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-xs",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(l.Play,{className:"w-3 h-3 text-white/40"}),(0,t.jsxs)("span",{className:"text-white/60",children:[e.actions?.length||0," actions"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(r.CheckCircle,{className:"w-3 h-3 text-green-400"}),(0,t.jsxs)("span",{className:"text-white/60",children:[e.successCount," success"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(c.XCircle,{className:"w-3 h-3 text-red-400"}),(0,t.jsxs)("span",{className:"text-white/60",children:[e.failureCount," failed"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(a.Zap,{className:"w-3 h-3 text-purple-400"}),(0,t.jsxs)("span",{className:"text-white/60",children:["Priority: ",e.priority]})]})]}),e.actions&&e.actions.length>0&&(0,t.jsxs)("div",{className:"mt-3 flex flex-wrap gap-1",children:[e.actions.slice(0,4).map((e,s)=>(0,t.jsx)("span",{className:"text-xs bg-purple-500/20 text-purple-300 px-2 py-0.5 rounded",children:e.actionType.replace(/_/g," ")},s)),e.actions.length>4&&(0,t.jsxs)("span",{className:"text-xs text-white/40",children:["+",e.actions.length-4," more"]})]})]},e.id))})]}),(0,t.jsxs)("section",{className:"glass-panel p-6 shadow-lg shadow-purple-500/5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,t.jsx)(i.Clock,{className:"w-4 h-4 text-purple-400"}),(0,t.jsx)("h3",{className:"text-sm font-bold text-white/30 uppercase tracking-widest",children:"Recent Executions"})]}),(0,t.jsx)("div",{className:"space-y-2",children:0===d.length?(0,t.jsx)("div",{className:"text-center text-white/30 text-sm py-8",children:"No executions yet"}):d.map(e=>(0,t.jsxs)("div",{className:"p-3 rounded-lg bg-white/5 border border-white/10",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"font-medium text-sm",children:e.playbook?.name}),(0,t.jsx)("span",{className:`text-xs px-2 py-1 rounded ${(e=>{switch(e){case"completed":return"text-green-400 bg-green-500/20";case"running":return"text-blue-400 bg-blue-500/20";case"failed":return"text-red-400 bg-red-500/20";default:return"text-yellow-400 bg-yellow-500/20"}})(e.status)}`,children:e.status})]}),(0,t.jsx)("div",{className:"text-xs text-white/40",children:new Date(e.startTime).toLocaleString()})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-xs text-white/40",children:[(0,t.jsxs)("span",{children:["Triggered by: ",e.triggeredBy]}),e.duration&&(0,t.jsxs)("span",{children:["Duration: ",e.duration,"s"]}),e.alertId&&(0,t.jsxs)("span",{children:["Alert: ",e.alertId.slice(0,8),"..."]})]}),e.error&&(0,t.jsxs)("div",{className:"mt-2 text-xs text-red-400 bg-red-500/10 rounded p-2",children:["Error: ",e.error]})]},e.id))})]})]})}e.s(["default",()=>o],84554)}]);