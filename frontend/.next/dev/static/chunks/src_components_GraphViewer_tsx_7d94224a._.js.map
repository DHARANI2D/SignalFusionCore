{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/dharanidharansenthilkumar/Projects/SignalFusion%20Core/frontend/src/components/GraphViewer.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef, useState } from \"react\";\nimport cytoscape from \"cytoscape\";\n// @ts-ignore\nimport coseBilkent from \"cytoscape-cose-bilkent\";\n\ncytoscape.use(coseBilkent);\n\ninterface GraphViewerProps {\n    graphData: any;\n}\n\nexport function GraphViewer({ graphData }: GraphViewerProps) {\n    const containerRef = useRef<HTMLDivElement>(null);\n    const cyRef = useRef<any>(null);\n    const [selectedNode, setSelectedNode] = useState<any>(null);\n\n    useEffect(() => {\n        if (!containerRef.current || !graphData) return;\n\n        // Initialize Cytoscape\n        const cy = cytoscape({\n            container: containerRef.current,\n            elements: graphData.elements || { nodes: [], edges: [] },\n            style: [\n                {\n                    selector: \"node\",\n                    style: {\n                        \"background-color\": (ele: any) => {\n                            const type = ele.data(\"type\");\n                            if (type === \"alert\") return \"#EF4444\"; // Vibrant Red\n                            if (type === \"entity\") return \"#3B82F6\"; // Bright Blue\n                            if (type === \"technique\") return \"#A855F7\"; // Purple\n                            return \"#9CA3AF\";\n                        },\n                        \"border-width\": 3,\n                        \"border-color\": \"#FFFFFF\",\n                        \"border-opacity\": 0.2,\n                        \"label\": \"data(label)\",\n                        \"color\": \"#FFFFFF\",\n                        \"text-valign\": \"bottom\",\n                        \"text-halign\": \"center\",\n                        \"text-margin-y\": 8,\n                        \"font-size\": \"12px\",\n                        \"font-family\": \"Inter, system-ui, sans-serif\",\n                        \"font-weight\": \"bold\",\n                        \"text-outline-width\": 2,\n                        \"text-outline-color\": \"#0F172A\",\n                        \"width\": (ele: any) => {\n                            const type = ele.data(\"type\");\n                            return type === \"alert\" ? 50 : 40;\n                        },\n                        \"height\": (ele: any) => {\n                            const type = ele.data(\"type\");\n                            return type === \"alert\" ? 50 : 40;\n                        },\n                        \"z-index\": 10\n                    }\n                },\n                {\n                    selector: \"edge\",\n                    style: {\n                        \"width\": 3,\n                        \"line-color\": \"#334155\",\n                        \"target-arrow-color\": \"#334155\",\n                        \"target-arrow-shape\": \"triangle\",\n                        \"curve-style\": \"bezier\",\n                        \"opacity\": 0.8,\n                        \"arrow-scale\": 1.5\n                    }\n                },\n                {\n                    selector: \"node:selected\",\n                    style: {\n                        \"border-width\": 6,\n                        \"border-color\": \"#60A5FA\",\n                        \"background-color\": \"#2563EB\",\n                        \"text-outline-color\": \"#2563EB\"\n                    }\n                }\n            ],\n            layout: {\n                name: \"cose-bilkent\",\n                animate: true,\n                animationDuration: 1500,\n                nodeDimensionsIncludeLabels: true,\n                idealEdgeLength: 150,\n                nodeRepulsion: 12000,\n                gravity: 0.1,\n                numIter: 3000,\n                initialTemp: 500,\n                coolingFactor: 0.98,\n                minTemp: 1.0,\n                padding: 100,\n                fit: true\n            } as any,\n            minZoom: 0.1,\n            maxZoom: 5,\n            wheelSensitivity: 0.1\n        });\n\n        // Ensure graph fits container initially and after layout\n        cy.on(\"layoutstop\", () => {\n            cy.fit(undefined as any, 100);\n        });\n\n        // Event handlers\n        cy.on(\"tap\", \"node\", (evt: any) => {\n            const node = evt.target;\n            setSelectedNode(node.data());\n        });\n\n        cy.on(\"tap\", (evt: any) => {\n            if (evt.target === cy) {\n                setSelectedNode(null);\n            }\n        });\n\n        cyRef.current = cy;\n\n        // Final fit after small delay to handle parent container sizing\n        setTimeout(() => cy.fit(undefined as any, 100), 500);\n\n        return () => {\n            cy.destroy();\n        };\n    }, [graphData]);\n\n    return (\n        <div className=\"relative w-full h-full\">\n            <div ref={containerRef} className=\"w-full h-full bg-black/20 rounded-lg border border-white/10\" />\n\n            {/* Controls */}\n            <div className=\"absolute top-4 right-4 flex flex-col gap-2\">\n                <button\n                    onClick={() => cyRef.current?.fit(50)}\n                    className=\"px-3 py-2 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-lg border border-white/10 text-xs font-medium transition-all\"\n                >\n                    Fit View\n                </button>\n                <button\n                    onClick={() => cyRef.current?.zoom(cyRef.current.zoom() * 1.2)}\n                    className=\"px-3 py-2 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-lg border border-white/10 text-xs font-medium transition-all\"\n                >\n                    Zoom In\n                </button>\n                <button\n                    onClick={() => cyRef.current?.zoom(cyRef.current.zoom() * 0.8)}\n                    className=\"px-3 py-2 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-lg border border-white/10 text-xs font-medium transition-all\"\n                >\n                    Zoom Out\n                </button>\n            </div>\n\n            {/* Node Info Panel */}\n            {selectedNode && (\n                <div className=\"absolute bottom-4 left-4 right-4 glass-panel p-4 max-w-md\">\n                    <div className=\"flex items-start justify-between mb-3\">\n                        <div>\n                            <div className=\"text-sm font-bold\">{selectedNode.label}</div>\n                            <div className=\"text-xs text-white/40 mt-1\">Type: {selectedNode.type}</div>\n                        </div>\n                        <button\n                            onClick={() => setSelectedNode(null)}\n                            className=\"text-white/40 hover:text-white text-xs\"\n                        >\n                            âœ•\n                        </button>\n                    </div>\n                    {selectedNode.severity && (\n                        <div className=\"text-xs\">\n                            <span className=\"text-white/40\">Severity: </span>\n                            <span className={`font-bold ${selectedNode.severity === \"critical\" ? \"text-red-400\" :\n                                selectedNode.severity === \"high\" ? \"text-orange-400\" :\n                                    selectedNode.severity === \"medium\" ? \"text-yellow-400\" :\n                                        \"text-blue-400\"\n                                }`}>\n                                {selectedNode.severity}\n                            </span>\n                        </div>\n                    )}\n                </div>\n            )}\n\n            {/* Legend */}\n            <div className=\"absolute top-4 left-4 glass-panel p-3\">\n                <div className=\"text-[10px] font-bold text-white/30 uppercase tracking-widest mb-2\">Legend</div>\n                <div className=\"flex flex-col gap-2 text-xs\">\n                    <div className=\"flex items-center gap-2\">\n                        <div className=\"w-4 h-4 rounded-full bg-red-500 border-2 border-red-600\" />\n                        <span className=\"text-white/60\">Alert</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                        <div className=\"w-4 h-4 rounded-full bg-blue-500 border-2 border-blue-600\" />\n                        <span className=\"text-white/60\">Entity</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                        <div className=\"w-4 h-4 rounded-full bg-purple-500 border-2 border-purple-600\" />\n                        <span className=\"text-white/60\">Technique</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}}]
}