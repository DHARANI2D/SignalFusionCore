module.exports=[48412,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(73320);let e=(0,a.i(70106).default)("file-braces",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);var f=a.i(35125),g=a.i(90669),h=a.i(92e3),i=a.i(16201),j=a.i(62722),k=a.i(25015),l=a.i(48124);let m="signalFusion_simulator";function n(){let[a,n]=(0,c.useState)("endpoint"),[o,p]=(0,c.useState)("PROCESS_START"),[q,r]=(0,c.useState)(`{
  "timestamp": "${new Date().toISOString()}",
  "process": "mimikatz.exe",
  "parent_process": "powershell.exe",
  "user": "admin",
  "hostname": "WORKSTATION-042",
  "command_line": "mimikatz.exe sekurlsa::logonpasswords",
  "pid": 4892
}`),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)({totalSent:0,successful:0,failed:0,alertsGenerated:0}),[A,B]=(0,c.useState)([]),C=(0,c.useRef)(null),D=(0,c.useRef)(null);(0,c.useEffect)(()=>{let a=localStorage.getItem(m);if(a){let b=JSON.parse(a);z(b.stats||{totalSent:0,successful:0,failed:0,alertsGenerated:0}),B(b.logs||[]),x(b.isRunning||!1),b.isRunning&&b.stats.totalSent<100&&G()}return D.current=setInterval(()=>{let a=localStorage.getItem(m);if(a){let b=JSON.parse(a);z(b.stats||y),B(b.logs||[]),x(b.isRunning||!1)}},1e3),()=>{D.current&&clearInterval(D.current)}},[]);let E=async()=>{v(!0),t(null);try{let b=JSON.parse(q),c={source:a,log:{eventType:o,...b}},d=await fetch("http://localhost:8001/api/ingest",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),e=await d.json();t(e)}catch(a){t({error:a.message})}finally{v(!1)}},F=(a,b,c)=>{localStorage.setItem(m,JSON.stringify({stats:a,logs:b,isRunning:c,lastUpdate:new Date().toISOString()}))},G=()=>{C.current||(C.current=setInterval(async()=>{let a,b,c,d,e=localStorage.getItem(m);if(!e)return;let f=JSON.parse(e);if(!f.isRunning||f.stats.totalSent>=100){C.current&&(clearInterval(C.current),C.current=null),F(f.stats,f.logs,!1);return}let{source:g,log:h}=(b=(a=["auth","endpoint","network","cloud"])[Math.floor(Math.random()*a.length)],d=((c=.3>Math.random())?{auth:[{eventType:"BRUTE_FORCE",user:"root",source_ip:"185.220.101.45",attempts:50,type:"malicious"}],endpoint:[{eventType:"PROCESS_START",process:"mimikatz.exe",user:"admin",hostname:"DESK-001",type:"malicious"}],network:[{eventType:"CONNECTION",source_ip:"10.0.0.50",dest_ip:"185.220.101.45",port:443,type:"malicious"}],cloud:[{eventType:"S3_ACCESS",resource:"s3://sensitive/creds.zip",user:"svc",action:"DOWNLOAD",type:"malicious"}]}:{auth:[{eventType:"LOGIN_SUCCESS",user:"alice.smith",source_ip:"10.0.1.50",type:"normal"}],endpoint:[{eventType:"PROCESS_START",process:"chrome.exe",user:"alice",hostname:"DESK-001",type:"normal"}],network:[{eventType:"CONNECTION",source_ip:"10.0.1.50",dest_ip:"8.8.8.8",port:443,type:"normal"}],cloud:[{eventType:"S3_ACCESS",resource:"s3://docs/report.pdf",user:"alice",action:"READ",type:"normal"}]})[b],{source:b,log:d[Math.floor(Math.random()*d.length)],isMalicious:c});try{let a=await fetch("http://localhost:8001/api/ingest",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:g,log:h})}),b=await a.json(),c={totalSent:f.stats.totalSent+1,successful:f.stats.successful+1,failed:f.stats.failed,alertsGenerated:f.stats.alertsGenerated+(b.alertsGenerated||0)},d=[{timestamp:new Date().toISOString(),source:g,eventType:h.eventType,status:"success",alerts:b.alertsGenerated||0,isMalicious:"malicious"===h.type,details:h.user||h.process||h.domain||h.resource||""},...f.logs.slice(0,19)],e=c.totalSent<100;F(c,d,e),!e&&C.current&&(clearInterval(C.current),C.current=null)}catch(a){F({...f.stats,totalSent:f.stats.totalSent+1,failed:f.stats.failed+1},f.logs,f.stats.totalSent+1<100)}},1500))};(0,c.useEffect)(()=>()=>{C.current&&clearInterval(C.current)},[]);let H={auth:`{
  "timestamp": "${new Date().toISOString()}",
  "user": "admin",
  "source_ip": "185.220.101.45",
  "result": "FAILED",
  "attempts": 15,
  "geo_location": "TOR_EXIT_NODE"
}`,endpoint:`{
  "timestamp": "${new Date().toISOString()}",
  "process": "mimikatz.exe",
  "parent_process": "powershell.exe",
  "user": "admin",
  "hostname": "WORKSTATION-042",
  "command_line": "mimikatz.exe sekurlsa::logonpasswords",
  "pid": 4892
}`,network:`{
  "timestamp": "${new Date().toISOString()}",
  "source_ip": "10.0.0.50",
  "dest_ip": "185.220.101.45",
  "port": 443,
  "protocol": "HTTPS",
  "bytes_transferred": 1048576,
  "domain": "suspicious-c2-server.com"
}`,cloud:`{
  "timestamp": "${new Date().toISOString()}",
  "resource": "s3://company-secrets/credentials.zip",
  "user": "compromised-service-account",
  "action": "DOWNLOAD",
  "size": 52428800,
  "region": "us-east-1"
}`};return(0,b.jsxs)("div",{className:"flex flex-col gap-8 flex-1 max-w-7xl mx-auto w-full",children:[(0,b.jsx)("header",{className:"flex justify-between items-end",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Log Ingestion"}),(0,b.jsx)("p",{className:"text-white/50 mt-1",children:"Manual and automated security log ingestion"})]})}),(0,b.jsxs)("section",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 flex flex-col gap-6",children:[(0,b.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-blue-500/5",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(g.Activity,{className:`w-4 h-4 ${w?"text-green-500":"text-white/40"}`}),(0,b.jsx)("h3",{className:"text-sm font-bold text-white/30 uppercase tracking-widest",children:"Data Simulator"}),w&&(0,b.jsx)("span",{className:"text-xs text-green-400",children:"â— Running (stops at 100)"})]}),(0,b.jsxs)("button",{onClick:w?()=>{F(y,A,!1),x(!1),C.current&&(clearInterval(C.current),C.current=null)}:()=>{let a={totalSent:0,successful:0,failed:0,alertsGenerated:0};F(a,[],!0),x(!0),z(a),B([]),G()},className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ${w?"bg-red-500/20 text-red-400 hover:bg-red-500/30":"bg-green-500/20 text-green-400 hover:bg-green-500/30"}`,children:[w?(0,b.jsx)(l.Square,{className:"w-4 h-4"}):(0,b.jsx)(k.Play,{className:"w-4 h-4"}),w?"Stop":"Start"]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-4 gap-3",children:[(0,b.jsxs)("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:[(0,b.jsx)("div",{className:"text-xs text-white/40 mb-1",children:"Total"}),(0,b.jsxs)("div",{className:"text-2xl font-bold",children:[y.totalSent||0,(0,b.jsx)("span",{className:"text-sm text-white/30",children:"/100"})]})]}),(0,b.jsxs)("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:[(0,b.jsx)("div",{className:"text-xs text-white/40 mb-1",children:"Success"}),(0,b.jsx)("div",{className:"text-2xl font-bold text-green-400",children:y.successful||0})]}),(0,b.jsxs)("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:[(0,b.jsx)("div",{className:"text-xs text-white/40 mb-1",children:"Failed"}),(0,b.jsx)("div",{className:"text-2xl font-bold text-red-400",children:y.failed||0})]}),(0,b.jsxs)("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:[(0,b.jsx)("div",{className:"text-xs text-white/40 mb-1",children:"Alerts"}),(0,b.jsx)("div",{className:"text-2xl font-bold text-orange-400",children:y.alertsGenerated||0})]})]})]}),(0,b.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-blue-500/5",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-sm font-bold text-white/30 uppercase tracking-widest",children:"Live Activity Feed"}),(0,b.jsxs)("span",{className:"text-xs text-white/30",children:[A.length,"/20 events"]})]}),(0,b.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:0===A.length?(0,b.jsx)("div",{className:"text-center text-white/30 text-sm py-8",children:"Start simulator to see activity"}):A.map((a,c)=>(0,b.jsxs)("div",{className:`flex items-center gap-3 p-3 rounded-lg border transition-colors ${a.isMalicious?"bg-red-500/5 border-red-500/20 hover:bg-red-500/10":"bg-white/5 border-white/10 hover:bg-white/10"}`,children:["success"===a.status?(0,b.jsx)(i.CheckCircle,{className:`w-4 h-4 flex-shrink-0 ${a.isMalicious?"text-orange-400":"text-green-400"}`}):(0,b.jsx)(j.XCircle,{className:"w-4 h-4 text-red-400 flex-shrink-0"}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)("span",{className:"text-white/40 text-xs",children:new Date(a.timestamp).toLocaleTimeString()}),(0,b.jsx)("span",{className:`font-medium ${"auth"===a.source?"text-blue-400":"endpoint"===a.source?"text-purple-400":"network"===a.source?"text-cyan-400":"text-green-400"}`,children:a.source}),(0,b.jsx)("span",{className:"text-white/60 text-xs",children:a.eventType}),a.isMalicious&&(0,b.jsx)("span",{className:"text-xs bg-red-500/20 text-red-300 px-2 py-0.5 rounded",children:"Suspicious"})]}),a.alerts>0&&(0,b.jsxs)("div",{className:"flex items-center gap-1 text-xs text-orange-400 mt-1",children:[(0,b.jsx)(h.AlertCircle,{className:"w-3 h-3"}),a.alerts," alert",a.alerts>1?"s":""," generated"]})]})]},c))})]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,b.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-blue-500/5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,b.jsx)(e,{className:"w-4 h-4 text-blue-400"}),(0,b.jsx)("h3",{className:"text-sm font-bold text-white/30 uppercase tracking-widest",children:"Manual Ingest"})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-white/40 mb-1.5",children:"Source"}),(0,b.jsxs)("select",{value:a,onChange:a=>{n(a.target.value),r(H[a.target.value])},className:"w-full bg-white/5 text-white rounded-lg px-3 py-2 border border-white/10 text-sm focus:outline-none focus:border-blue-500/50 transition-colors",children:[(0,b.jsx)("option",{value:"auth",children:"Authentication"}),(0,b.jsx)("option",{value:"endpoint",children:"Endpoint"}),(0,b.jsx)("option",{value:"network",children:"Network"}),(0,b.jsx)("option",{value:"cloud",children:"Cloud"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-white/40 mb-1.5",children:"Event Type"}),(0,b.jsx)("input",{type:"text",value:o,onChange:a=>p(a.target.value),className:"w-full bg-white/5 text-white rounded-lg px-3 py-2 border border-white/10 text-sm focus:outline-none focus:border-blue-500/50 transition-colors",placeholder:"e.g., LOGIN_FAIL"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-white/40 mb-1.5",children:"Event Data (JSON)"}),(0,b.jsx)("textarea",{value:q,onChange:a=>r(a.target.value),rows:8,className:"w-full bg-white/5 text-white rounded-lg px-3 py-2 border border-white/10 text-sm font-mono focus:outline-none focus:border-blue-500/50 transition-colors resize-none"})]}),(0,b.jsxs)("button",{onClick:E,disabled:u,className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-2.5 px-4 rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-sm",children:[(0,b.jsx)(d.Upload,{className:"w-4 h-4"}),u?"Ingesting...":"Ingest Event"]})]}),s&&(0,b.jsxs)("div",{className:"mt-4 bg-white/5 rounded-lg p-3 border border-white/10",children:[(0,b.jsx)("div",{className:"text-xs text-white/40 mb-2",children:"Response"}),(0,b.jsx)("pre",{className:"text-xs text-white/60 overflow-auto max-h-32 font-mono",children:JSON.stringify(s,null,2)})]})]}),(0,b.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-blue-500/5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,b.jsx)(f.Server,{className:"w-4 h-4 text-purple-400"}),(0,b.jsx)("h3",{className:"text-sm font-bold text-white/30 uppercase tracking-widest",children:"Enterprise API"})]}),(0,b.jsxs)("div",{className:"space-y-2 text-xs",children:[(0,b.jsxs)("div",{className:"bg-white/5 rounded p-2 border border-white/10",children:[(0,b.jsx)("div",{className:"text-white/60 font-medium mb-0.5",children:"Batch Ingestion"}),(0,b.jsx)("code",{className:"text-blue-400 text-xs",children:"POST /api/enterprise/ingest/batch"}),(0,b.jsx)("div",{className:"text-white/30 mt-1",children:"JSON arrays â€¢ Bulk processing"})]}),(0,b.jsxs)("div",{className:"bg-white/5 rounded p-2 border border-white/10",children:[(0,b.jsx)("div",{className:"text-white/60 font-medium mb-0.5",children:"Syslog Receiver"}),(0,b.jsx)("code",{className:"text-cyan-400 text-xs",children:"POST /api/enterprise/ingest/syslog"}),(0,b.jsx)("div",{className:"text-white/30 mt-1",children:"CEF/LEEF â€¢ Firewall logs"})]}),(0,b.jsxs)("div",{className:"bg-white/5 rounded p-2 border border-white/10",children:[(0,b.jsx)("div",{className:"text-white/60 font-medium mb-0.5",children:"Webhook Integration"}),(0,b.jsx)("code",{className:"text-purple-400 text-xs",children:"POST /api/enterprise/ingest/webhook"}),(0,b.jsx)("div",{className:"text-white/30 mt-1",children:"Splunk â€¢ Elastic â€¢ Sentinel"})]}),(0,b.jsxs)("div",{className:"bg-white/5 rounded p-2 border border-white/10",children:[(0,b.jsx)("div",{className:"text-white/60 font-medium mb-0.5",children:"SIEM Polling"}),(0,b.jsx)("code",{className:"text-green-400 text-xs",children:"POST /api/enterprise/ingest/poll"}),(0,b.jsx)("div",{className:"text-white/30 mt-1",children:"Scheduled queries â€¢ Cron jobs"})]}),(0,b.jsxs)("div",{className:"bg-white/5 rounded p-2 border border-white/10",children:[(0,b.jsx)("div",{className:"text-white/60 font-medium mb-0.5",children:"File Watcher"}),(0,b.jsx)("code",{className:"text-orange-400 text-xs",children:"POST /api/enterprise/ingest/watch"}),(0,b.jsx)("div",{className:"text-white/30 mt-1",children:"Directory monitoring"})]}),(0,b.jsx)("div",{className:"mt-3 p-2 bg-blue-500/10 border border-blue-500/20 rounded",children:(0,b.jsxs)("div",{className:"text-blue-300 text-xs",children:["ðŸ“š ",(0,b.jsx)("code",{className:"bg-white/10 px-1 rounded",children:"ENTERPRISE_INGESTION.md"})]})})]})]})]})]})]})}a.s(["default",()=>n],48412)}];

//# sourceMappingURL=src_app_ingest_page_tsx_02a03b95._.js.map