module.exports=[33354,(a,b,c)=>{"use strict";c._=function(a){return a&&a.__esModule?a:{default:a}}},32245,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"BailoutToCSR",{enumerable:!0,get:function(){return e}});let d=a.r(41997);function e({reason:a,children:b}){throw Object.defineProperty(new d.BailoutToCSRError(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0})}},7773,(a,b,c)=>{"use strict";function d(a){return a.split("/").map(a=>encodeURIComponent(a)).join("/")}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"encodeURIPath",{enumerable:!0,get:function(){return d}})},97458,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"PreloadChunks",{enumerable:!0,get:function(){return i}});let d=a.r(87924),e=a.r(35112),f=a.r(56704),g=a.r(7773),h=a.r(68063);function i({moduleIds:a}){let b=f.workAsyncStorage.getStore();if(void 0===b)return null;let c=[];if(b.reactLoadableManifest&&a){let d=b.reactLoadableManifest;for(let b of a){if(!d[b])continue;let a=d[b].files;c.push(...a)}}if(0===c.length)return null;let i=(0,h.getDeploymentIdQueryOrEmptyString)();return(0,d.jsx)(d.Fragment,{children:c.map(a=>{let c=`${b.assetPrefix}/_next/${(0,g.encodeURIPath)(a)}${i}`;return a.endsWith(".css")?(0,d.jsx)("link",{precedence:"dynamic",href:c,rel:"stylesheet",as:"style",nonce:b.nonce},a):((0,e.preload)(c,{as:"script",fetchPriority:"low",nonce:b.nonce}),null)})})}},69853,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return j}});let d=a.r(87924),e=a.r(72131),f=a.r(32245),g=a.r(97458);function h(a){return{default:a&&"default"in a?a.default:a}}let i={loader:()=>Promise.resolve(h(()=>null)),loading:null,ssr:!0},j=function(a){let b={...i,...a},c=(0,e.lazy)(()=>b.loader().then(h)),j=b.loading;function k(a){let h=j?(0,d.jsx)(j,{isLoading:!0,pastDelay:!0,error:null}):null,i=!b.ssr||!!b.loading,k=i?e.Suspense:e.Fragment,l=b.ssr?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.PreloadChunks,{moduleIds:b.modules}),(0,d.jsx)(c,{...a})]}):(0,d.jsx)(f.BailoutToCSR,{reason:"next/dynamic",children:(0,d.jsx)(c,{...a})});return(0,d.jsx)(k,{...i?{fallback:h}:{},children:l})}return k.displayName="LoadableComponent",k}},19721,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return e}});let d=a.r(33354)._(a.r(69853));function e(a,b){let c={};"function"==typeof a&&(c.loader=a);let e={...c,...b};return(0,d.default)({...e,modules:e.loadableGenerated?.modules})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},61841,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(62214),e=a.i(92e3);let f=(0,a.i(70106).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);var g=a.i(35125),h=a.i(90669),i=a.i(3314);let j=(0,a.i(19721).default)(async()=>{},{loadableGenerated:{modules:[8252]},ssr:!1,loading:()=>(0,b.jsx)("div",{className:"flex items-center justify-center h-full text-white/50",children:"Loading graph..."})});function k(){let[a,k]=(0,c.useState)([]),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(!0);(0,c.useEffect)(()=>{r(),s()},[]);let r=async()=>{try{let a=await fetch("http://localhost:8001/api/attack-graph/chains"),b=await a.json();k(b.chains||[]),q(!1)}catch(a){console.error("Failed to fetch chains:",a),q(!1)}},s=async()=>{try{let a=await fetch("http://localhost:8001/api/attack-graph/export?format=cytoscape"),b=await a.json();m(b)}catch(a){console.error("Failed to fetch graph:",a)}};return p?(0,b.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,b.jsxs)("div",{className:"text-white/50 flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),"Loading attack graph..."]})}):(0,b.jsxs)("div",{className:"flex flex-col gap-8 flex-1 max-w-7xl mx-auto w-full",children:[(0,b.jsxs)("header",{className:"flex justify-between items-end border-b border-white/5 pb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight bg-gradient-to-r from-white via-white to-white/50 bg-clip-text text-transparent",children:"Attack Graph"}),(0,b.jsx)("p",{className:"text-white/40 mt-2 text-sm",children:"Visualize attack chains and lateral movement"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-white/30",children:[(0,b.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),(0,b.jsx)("span",{children:"Live Data"})]})]}),(0,b.jsxs)("section",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,b.jsx)("div",{className:"glass-panel p-6 shadow-lg shadow-blue-500/5 hover:shadow-blue-500/10 transition-all group",children:(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-lg bg-blue-500/10 border border-blue-500/20 flex items-center justify-center group-hover:bg-blue-500/20 transition-all",children:(0,b.jsx)(d.Network,{className:"w-5 h-5 text-blue-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-white/40",children:"Attack Chains"}),(0,b.jsx)("div",{className:"text-2xl font-bold mt-1",children:a.length})]})]})}),(0,b.jsx)("div",{className:"glass-panel p-6 shadow-lg shadow-orange-500/5 hover:shadow-orange-500/10 transition-all group",children:(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-lg bg-orange-500/10 border border-orange-500/20 flex items-center justify-center group-hover:bg-orange-500/20 transition-all",children:(0,b.jsx)(e.AlertCircle,{className:"w-5 h-5 text-orange-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-white/40",children:"Active Chains"}),(0,b.jsx)("div",{className:"text-2xl font-bold mt-1",children:a.filter(a=>"active"===a.status).length})]})]})}),(0,b.jsx)("div",{className:"glass-panel p-6 shadow-lg shadow-purple-500/5 hover:shadow-purple-500/10 transition-all group",children:(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-lg bg-purple-500/10 border border-purple-500/20 flex items-center justify-center group-hover:bg-purple-500/20 transition-all",children:(0,b.jsx)(f,{className:"w-5 h-5 text-purple-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-white/40",children:"Affected Users"}),(0,b.jsx)("div",{className:"text-2xl font-bold mt-1",children:new Set(a.flatMap(a=>a.users?JSON.parse(a.users):[])).size||0})]})]})}),(0,b.jsx)("div",{className:"glass-panel p-6 shadow-lg shadow-green-500/5 hover:shadow-green-500/10 transition-all group",children:(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-lg bg-green-500/10 border border-green-500/20 flex items-center justify-center group-hover:bg-green-500/20 transition-all",children:(0,b.jsx)(g.Server,{className:"w-5 h-5 text-green-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-white/40",children:"Affected Hosts"}),(0,b.jsx)("div",{className:"text-2xl font-bold mt-1",children:new Set(a.flatMap(a=>a.hosts?JSON.parse(a.hosts):[])).size||0})]})]})})]}),(0,b.jsxs)("section",{className:"glass-panel p-6 shadow-lg shadow-blue-500/5",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-500/10 border border-blue-500/20 flex items-center justify-center",children:(0,b.jsx)(d.Network,{className:"w-4 h-4 text-blue-400"})}),(0,b.jsx)("h3",{className:"text-sm font-bold text-white/60 uppercase tracking-widest",children:"Interactive Graph"})]})}),(0,b.jsx)("div",{className:"h-[600px] rounded-lg overflow-hidden",children:l?(0,b.jsx)(j,{graphData:l}):(0,b.jsx)("div",{className:"flex items-center justify-center h-full bg-black/20 rounded-lg border border-white/10",children:(0,b.jsx)("div",{className:"text-white/40",children:"Loading graph data..."})})})]}),(0,b.jsxs)("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-blue-500/5",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-500/10 border border-blue-500/20 flex items-center justify-center",children:(0,b.jsx)(h.Activity,{className:"w-4 h-4 text-blue-400"})}),(0,b.jsx)("h3",{className:"text-sm font-bold text-white/60 uppercase tracking-widest",children:"Detected Chains"})]})}),(0,b.jsx)("div",{className:"space-y-3 max-h-[600px] overflow-y-auto",children:0===a.length?(0,b.jsxs)("div",{className:"text-center text-white/20 text-sm py-12 flex flex-col items-center gap-3",children:[(0,b.jsx)(d.Network,{className:"w-12 h-12 text-white/10"}),(0,b.jsx)("p",{children:"No attack chains detected"})]}):a.map(a=>(0,b.jsxs)("div",{onClick:()=>o(a),className:`p-4 rounded-lg border cursor-pointer transition-all ${n?.id===a.id?"bg-blue-500/20 border-blue-500/50":"bg-white/5 border-white/10 hover:bg-white/10"}`,children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,b.jsx)("div",{className:"font-medium",children:a.name}),(0,b.jsx)("span",{className:`text-xs px-2 py-1 rounded border ${(a=>{switch(a.toLowerCase()){case"critical":return"text-red-400 bg-red-500/20 border-red-500/30";case"high":return"text-orange-400 bg-orange-500/20 border-orange-500/30";case"medium":return"text-yellow-400 bg-yellow-500/20 border-yellow-500/30";default:return"text-blue-400 bg-blue-500/20 border-blue-500/30"}})(a.severity)}`,children:a.severity})]}),(0,b.jsx)("div",{className:"text-xs text-white/40 mb-3",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-xs",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(h.Activity,{className:"w-3 h-3 text-white/40"}),(0,b.jsxs)("span",{className:"text-white/60",children:[JSON.parse(a.nodeIds).length," events"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(i.Shield,{className:"w-3 h-3 text-white/40"}),(0,b.jsxs)("span",{className:"text-white/60",children:["Risk: ",Math.round(a.riskScore||0)]})]})]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1 mt-3",children:JSON.parse(a.tactics).slice(0,3).map((a,c)=>(0,b.jsx)("span",{className:"text-xs bg-purple-500/20 text-purple-300 px-2 py-0.5 rounded border border-purple-500/30",children:a},c))})]},a.id))})]}),(0,b.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-purple-500/5",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-lg bg-purple-500/10 border border-purple-500/20 flex items-center justify-center",children:(0,b.jsx)(d.Network,{className:"w-4 h-4 text-purple-400"})}),(0,b.jsx)("h3",{className:"text-sm font-bold text-white/60 uppercase tracking-widest",children:"Chain Details"})]})}),n?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-white/40 mb-2",children:"Timeline"}),(0,b.jsx)("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-white/40 text-xs",children:"Start"}),(0,b.jsx)("div",{className:"font-mono text-xs mt-1",children:new Date(n.startTime).toLocaleString()})]}),(0,b.jsx)("div",{className:"text-white/40",children:"â†’"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-white/40 text-xs",children:"End"}),(0,b.jsx)("div",{className:"font-mono text-xs mt-1",children:n.endTime?new Date(n.endTime).toLocaleString():"Ongoing"})]})]})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-white/40 mb-2",children:"MITRE ATT&CK Coverage"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-white/50 mb-1",children:"Tactics"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:JSON.parse(n.tactics).map((a,c)=>(0,b.jsx)("span",{className:"text-xs bg-blue-500/20 text-blue-300 px-2 py-1 rounded border border-blue-500/30",children:a},c))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-white/50 mb-1",children:"Techniques"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:JSON.parse(n.techniques).map((a,c)=>(0,b.jsx)("span",{className:"text-xs bg-purple-500/20 text-purple-300 px-2 py-1 rounded border border-purple-500/30 font-mono",children:a},c))})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-white/40 mb-2",children:"Risk Assessment"}),(0,b.jsxs)("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-sm",children:"Risk Score"}),(0,b.jsxs)("span",{className:"text-lg font-bold",children:[Math.round(n.riskScore||0),"/100"]})]}),(0,b.jsx)("div",{className:"h-2 bg-white/5 rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:"h-full bg-gradient-to-r from-orange-500 to-red-500",style:{width:`${n.riskScore||0}%`}})})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 pt-4 border-t border-white/5",children:[(0,b.jsx)("button",{className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium py-2 px-4 rounded-lg transition-all",children:"Investigate"}),(0,b.jsx)("button",{className:"flex-1 bg-white/10 hover:bg-white/20 text-white text-sm font-medium py-2 px-4 rounded-lg transition-all",children:"Mark Resolved"})]})]}):(0,b.jsxs)("div",{className:"text-center text-white/20 text-sm py-20 flex flex-col items-center gap-3",children:[(0,b.jsx)(i.Shield,{className:"w-16 h-16 text-white/10"}),(0,b.jsx)("p",{children:"Select a chain to view details"})]})]})]})]})}a.s(["default",()=>k],61841)}];

//# sourceMappingURL=_35a1028c._.js.map