module.exports=[25015,a=>{"use strict";let b=(0,a.i(70106).default)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);a.s(["Play",()=>b],25015)},41710,a=>{"use strict";let b=(0,a.i(70106).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);a.s(["Clock",()=>b],41710)},16201,62722,a=>{"use strict";var b=a.i(70106);let c=(0,b.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>c],16201);let d=(0,b.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);a.s(["XCircle",()=>d],62722)},42720,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(1027),e=a.i(25015),f=a.i(41710),g=a.i(16201),h=a.i(62722);let i=(0,a.i(70106).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);function j(){let[a,j]=(0,c.useState)([]),[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)(!0),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)({name:"",description:"",trigger:{severity:"High",riskScore:70},actions:[{name:"Notify Security Team",actionType:"notify_slack",parameters:{channel:"#soc-alerts",message:"High severity alert detected"}}],retroactive:!1}),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)("");(0,c.useEffect)(()=>{z(),A(),y()},[]);let y=async()=>{try{let a=await fetch("http://localhost:8001/api/alerts"),b=await a.json();r(b||[]),b&&b.length>0&&x(b[0].id)}catch(a){console.error("Failed to fetch alerts:",a)}},z=async()=>{try{let a=await fetch("http://localhost:8001/api/playbooks"),b=await a.json();j(b.playbooks||[]),n(!1)}catch(a){console.error("Failed to fetch playbooks:",a),n(!1)}},A=async()=>{try{let a=await fetch("http://localhost:8001/api/playbooks/executions"),b=await a.json();l(b.executions||[])}catch(a){console.error("Failed to fetch executions:",a)}},B=async()=>{try{let a=await fetch("http://localhost:8001/api/playbooks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),b=await a.json();b.success&&(s.retroactive&&await fetch(`http://localhost:8001/api/playbooks/${b.playbook.id}/retroactive`,{method:"POST"}),z(),A(),p(!1))}catch(a){console.error("Failed to create playbook:",a)}},C=async()=>{try{let a=await fetch("http://localhost:8001/api/playbooks/simulate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({playbook:s,alertId:w})}),b=await a.json();v(b)}catch(a){console.error("Failed to simulate playbook:",a)}};return m?(0,b.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,b.jsx)("div",{className:"text-white/50",children:"Loading playbooks..."})}):(0,b.jsxs)("div",{className:"flex flex-col gap-8 flex-1 max-w-7xl mx-auto w-full",children:[(0,b.jsxs)("header",{className:"flex justify-between items-end",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Response Playbooks"}),(0,b.jsx)("p",{className:"text-white/50 mt-1",children:"Automated incident response workflows"})]}),(0,b.jsxs)("button",{onClick:()=>p(!0),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium transition-all",children:[(0,b.jsx)(i,{className:"w-4 h-4"}),"Create Playbook"]})]}),o&&(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:(0,b.jsxs)("div",{className:"glass-panel w-full max-w-2xl max-h-[90vh] overflow-y-auto p-8 shadow-2xl",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsx)("h2",{className:"text-xl font-bold",children:"Create New Playbook"}),(0,b.jsx)("button",{onClick:()=>p(!1),className:"text-white/40 hover:text-white",children:"âœ•"})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-bold text-white/40 uppercase mb-2",children:"Name"}),(0,b.jsx)("input",{type:"text",value:s.name,onChange:a=>t({...s,name:a.target.value}),className:"w-full bg-white/5 border border-white/10 rounded-lg px-4 py-2 text-sm focus:border-blue-500/50 outline-none transition-all",placeholder:"e.g. Isolate Ransomware"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-bold text-white/40 uppercase mb-2",children:"Trigger Severity"}),(0,b.jsxs)("select",{value:s.trigger.severity,onChange:a=>t({...s,trigger:{...s.trigger,severity:a.target.value}}),className:"w-full bg-[#0a0a0c] border border-white/10 rounded-lg px-4 py-2 text-sm focus:border-blue-500/50 outline-none transition-all",children:[(0,b.jsx)("option",{value:"Critical",children:"Critical"}),(0,b.jsx)("option",{value:"High",children:"High"}),(0,b.jsx)("option",{value:"Medium",children:"Medium"}),(0,b.jsx)("option",{value:"Low",children:"Low"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-bold text-white/40 uppercase mb-2",children:"Description"}),(0,b.jsx)("textarea",{value:s.description,onChange:a=>t({...s,description:a.target.value}),className:"w-full bg-white/5 border border-white/10 rounded-lg px-4 py-2 text-sm h-20 focus:border-blue-500/50 outline-none transition-all",placeholder:"What does this playbook do?"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-bold text-white/40 uppercase mb-2",children:"Actions"}),(0,b.jsxs)("div",{className:"space-y-2",children:[s.actions.map((a,c)=>(0,b.jsxs)("div",{className:"bg-white/5 border border-white/10 rounded-lg p-3 flex justify-between items-center text-sm",children:[(0,b.jsxs)("span",{children:[a.name," (",a.actionType,")"]}),(0,b.jsx)("button",{onClick:()=>{let a=[...s.actions];a.splice(c,1),t({...s,actions:a})},className:"text-red-400",children:"Remove"})]},c)),(0,b.jsx)("button",{onClick:()=>t({...s,actions:[...s.actions,{name:"New Action",actionType:"isolate_host",parameters:{}}]}),className:"w-full py-2 border border-dashed border-white/20 rounded-lg text-xs text-white/40 hover:text-white/60 transition-all",children:"+ Add Action"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 bg-blue-500/10 border border-blue-500/20 p-4 rounded-lg",children:[(0,b.jsx)("input",{type:"checkbox",id:"retro",checked:s.retroactive,onChange:a=>t({...s,retroactive:a.target.checked}),className:"w-4 h-4 rounded"}),(0,b.jsx)("label",{htmlFor:"retro",className:"text-sm font-medium",children:"Retroactive Execution: Run on existing alerts matching criteria"})]}),(0,b.jsxs)("div",{className:"border-t border-white/5 pt-6",children:[(0,b.jsx)("h3",{className:"text-sm font-bold text-white/60 mb-4",children:"PLAYBOOK SIMULATOR"}),(0,b.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,b.jsx)("select",{value:w,onChange:a=>x(a.target.value),className:"flex-1 bg-[#0a0a0c] border border-white/10 rounded-lg px-4 py-2 text-sm",children:q.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.summary.slice(0,50),"..."]},a.id))}),(0,b.jsx)("button",{onClick:C,className:"px-6 py-2 bg-purple-500/20 border border-purple-500/30 text-purple-300 rounded-lg text-sm font-bold hover:bg-purple-500/30 transition-all",children:"Simulate"})]}),u&&(0,b.jsxs)("div",{className:`p-4 rounded-lg border ${u.matched?"bg-green-500/10 border-green-500/30":"bg-red-500/10 border-red-500/30"}`,children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,b.jsxs)("span",{className:"font-bold text-sm",children:["Result: ",u.matched?"MATCH":"NO MATCH"]}),(0,b.jsx)("span",{className:"text-xs",children:u.predictedOutcome})]}),(0,b.jsxs)("div",{className:"text-xs text-white/40",children:["Alert: ",u.alertSummary," (",u.alertSeverity,")"]})]})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-6 border-t border-white/5",children:[(0,b.jsx)("button",{onClick:()=>p(!1),className:"flex-1 px-4 py-2 rounded-lg bg-white/5 hover:bg-white/10 text-white text-sm font-medium transition-all",children:"Cancel"}),(0,b.jsx)("button",{onClick:B,className:"flex-1 px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium transition-all shadow-lg shadow-blue-500/20",children:"Create & Enable"})]})]})]})}),(0,b.jsxs)("section",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,b.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-blue-500/5",children:[(0,b.jsx)("div",{className:"text-sm text-white/40 mb-2",children:"Total Playbooks"}),(0,b.jsx)("div",{className:"text-3xl font-bold",children:a.length})]}),(0,b.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-green-500/5",children:[(0,b.jsx)("div",{className:"text-sm text-white/40 mb-2",children:"Enabled"}),(0,b.jsx)("div",{className:"text-3xl font-bold text-green-400",children:a.filter(a=>a.enabled).length})]}),(0,b.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-purple-500/5",children:[(0,b.jsx)("div",{className:"text-sm text-white/40 mb-2",children:"Total Executions"}),(0,b.jsx)("div",{className:"text-3xl font-bold text-purple-400",children:a.reduce((a,b)=>a+(b.executionCount||0),0)})]}),(0,b.jsxs)("div",{className:"glass-panel p-6 shadow-lg shadow-orange-500/5",children:[(0,b.jsx)("div",{className:"text-sm text-white/40 mb-2",children:"Success Rate"}),(0,b.jsxs)("div",{className:"text-3xl font-bold text-green-400",children:[a.length>0?Math.round(a.reduce((a,b)=>a+(b.successCount||0),0)/Math.max(a.reduce((a,b)=>a+(b.executionCount||0),0),1)*100):0,"%"]})]})]}),(0,b.jsxs)("section",{className:"glass-panel p-6 shadow-lg shadow-blue-500/5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,b.jsx)(d.Zap,{className:"w-4 h-4 text-blue-400"}),(0,b.jsx)("h3",{className:"text-sm font-bold text-white/30 uppercase tracking-widest",children:"Active Playbooks"})]}),(0,b.jsx)("div",{className:"space-y-3",children:0===a.length?(0,b.jsx)("div",{className:"text-center text-white/30 text-sm py-8",children:"No playbooks configured"}):a.map(a=>(0,b.jsxs)("div",{className:"p-4 rounded-lg bg-white/5 border border-white/10 hover:bg-white/10 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[(0,b.jsx)("span",{className:"font-medium",children:a.name}),(0,b.jsx)("span",{className:`text-xs px-2 py-1 rounded ${a.enabled?"bg-green-500/20 text-green-300":"bg-gray-500/20 text-gray-400"}`,children:a.enabled?"Enabled":"Disabled"}),a.autoExecute&&(0,b.jsx)("span",{className:"text-xs bg-blue-500/20 text-blue-300 px-2 py-1 rounded",children:"Auto"})]}),(0,b.jsx)("div",{className:"text-xs text-white/40",children:a.description||"No description"})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-sm font-bold",children:a.executionCount}),(0,b.jsx)("div",{className:"text-xs text-white/40",children:"executions"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-xs",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(e.Play,{className:"w-3 h-3 text-white/40"}),(0,b.jsxs)("span",{className:"text-white/60",children:[a.actions?.length||0," actions"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(g.CheckCircle,{className:"w-3 h-3 text-green-400"}),(0,b.jsxs)("span",{className:"text-white/60",children:[a.successCount," success"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(h.XCircle,{className:"w-3 h-3 text-red-400"}),(0,b.jsxs)("span",{className:"text-white/60",children:[a.failureCount," failed"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(d.Zap,{className:"w-3 h-3 text-purple-400"}),(0,b.jsxs)("span",{className:"text-white/60",children:["Priority: ",a.priority]})]})]}),a.actions&&a.actions.length>0&&(0,b.jsxs)("div",{className:"mt-3 flex flex-wrap gap-1",children:[a.actions.slice(0,4).map((a,c)=>(0,b.jsx)("span",{className:"text-xs bg-purple-500/20 text-purple-300 px-2 py-0.5 rounded",children:a.actionType.replace(/_/g," ")},c)),a.actions.length>4&&(0,b.jsxs)("span",{className:"text-xs text-white/40",children:["+",a.actions.length-4," more"]})]})]},a.id))})]}),(0,b.jsxs)("section",{className:"glass-panel p-6 shadow-lg shadow-purple-500/5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,b.jsx)(f.Clock,{className:"w-4 h-4 text-purple-400"}),(0,b.jsx)("h3",{className:"text-sm font-bold text-white/30 uppercase tracking-widest",children:"Recent Executions"})]}),(0,b.jsx)("div",{className:"space-y-2",children:0===k.length?(0,b.jsx)("div",{className:"text-center text-white/30 text-sm py-8",children:"No executions yet"}):k.map(a=>(0,b.jsxs)("div",{className:"p-3 rounded-lg bg-white/5 border border-white/10",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"font-medium text-sm",children:a.playbook?.name}),(0,b.jsx)("span",{className:`text-xs px-2 py-1 rounded ${(a=>{switch(a){case"completed":return"text-green-400 bg-green-500/20";case"running":return"text-blue-400 bg-blue-500/20";case"failed":return"text-red-400 bg-red-500/20";default:return"text-yellow-400 bg-yellow-500/20"}})(a.status)}`,children:a.status})]}),(0,b.jsx)("div",{className:"text-xs text-white/40",children:new Date(a.startTime).toLocaleString()})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-xs text-white/40",children:[(0,b.jsxs)("span",{children:["Triggered by: ",a.triggeredBy]}),a.duration&&(0,b.jsxs)("span",{children:["Duration: ",a.duration,"s"]}),a.alertId&&(0,b.jsxs)("span",{children:["Alert: ",a.alertId.slice(0,8),"..."]})]}),a.error&&(0,b.jsxs)("div",{className:"mt-2 text-xs text-red-400 bg-red-500/10 rounded p-2",children:["Error: ",a.error]})]},a.id))})]})]})}a.s(["default",()=>j],42720)}];

//# sourceMappingURL=_6ea0ba5e._.js.map